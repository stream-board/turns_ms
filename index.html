<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Project Architecture Turns</title>
    <link rel="stylesheet" href="">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.css">
</head>
<body>
    <div class="chat js-feak-info" data-sender="usuario">
    <h1>Stream board turns</h1>
    <button type="" class="js-ask-permission" data-user-id="1" data-user-nick="Usuario12">Pedir permiso</button>
    <button type="" class="js-set-admin" data-user-id="3" data-user-nick="AdminRoom">Ser administrador</button>
    <button type="" class="js-register-room" data-user-id="1" data-user-nick="Usuario12">Activarme en la sala</button>

    </div>
    <script src="/socket.io/socket.io.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-confirm/3.3.0/jquery-confirm.min.js"></script>
    <script type="text/javascript">
        $(function(){
            var socket = io();
            //ask if user is the room's admin: yes-> set admin ? -> register id

            //if: yes:
            $('.js-set-admin').on('click', function() {
                var adminId = $(this).data('user-id');
                socket.emit('set admin id', adminId);
            });
            //else:
            $('.js-register-room').on('click', function() {
                var userId = $(this).data('user-id');
                var userNick = $(this).data('user-nick');
                socket.emit('register id', userNick, userId);
            });

            $('.js-ask-permission').on('click', function() {
                var userId = $(this).data('user-id');
                var userNick = $(this).data('user-nick');
                socket.emit('ask for board', userId, userNick);
            });

            socket.on('ask for board', function(userId, userNick) {
                $.confirm({
                    title: 'Board permissions',
                    content: 'User ' + userNick + ' want board permissions',
                    buttons: {
                        confirm: function () {
                            //do http POST request to board-ms in .done to this
                            socket.emit('answer for board', true, userId, userNick);
                        },
                        cancel: function () {
                            socket.emit('answer for board', false, userId, userNick);
                        }
                    }
                });

            });

            socket.on('answer for board', function (msg) {
                $.alert({
                    title: 'Permisos Tablero',
                    content: msg,
                });
            });
        })
    </script>
</body>

</html>
